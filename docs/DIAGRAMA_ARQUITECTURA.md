# ğŸ“Š CLIMATOT ALMACÃ‰N - DIAGRAMA DE ARQUITECTURA Y FLUJOS

## ğŸ—ï¸ ARQUITECTURA DEL SISTEMA

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CLIMATOT ALMACÃ‰N v1.0                         â”‚
â”‚                   Sistema de GestiÃ³n Integral                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CAPA DE PRESENTACIÃ“N                          â”‚
â”‚                         (PySide6/Qt)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚    LOGIN     â”‚  â”‚ MENÃš PRINCIPALâ”‚  â”‚   MAESTROS   â”‚         â”‚
â”‚  â”‚   app.py     â”‚â†’â”‚   app.py      â”‚â†’â”‚   app.py     â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                            â”‚                                     â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚         â”‚                  â”‚                  â”‚                 â”‚
â”‚    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”          â”‚
â”‚    â”‚ OPERAC. â”‚      â”‚  CONSULTAS  â”‚    â”‚ INFORMES  â”‚          â”‚
â”‚    â”‚         â”‚      â”‚             â”‚    â”‚           â”‚          â”‚
â”‚    â”‚RecepciÃ³nâ”‚      â”‚   Stock     â”‚    â”‚ HistÃ³rico â”‚          â”‚
â”‚    â”‚Movimientâ”‚      â”‚   Ficha     â”‚    â”‚ Consumos  â”‚          â”‚
â”‚    â”‚ImputaciÃ³â”‚      â”‚ Inventarios â”‚    â”‚ AnÃ¡lisis  â”‚          â”‚
â”‚    â”‚Devoluci.â”‚      â”‚             â”‚    â”‚           â”‚          â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CAPA DE LÃ“GICA DE NEGOCIO                      â”‚
â”‚                         (Python Core)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   db_utils.py   â”‚  â”‚  estilos.py      â”‚  â”‚idle_manager.py â”‚ â”‚
â”‚  â”‚                 â”‚  â”‚                  â”‚  â”‚                â”‚ â”‚
â”‚  â”‚ â€¢ get_con()     â”‚  â”‚ â€¢ ESTILO_LOGIN   â”‚  â”‚ â€¢ Timeout      â”‚ â”‚
â”‚  â”‚ â€¢ hash_pwd()    â”‚  â”‚ â€¢ ESTILO_VENTANA â”‚  â”‚ â€¢ Monitoreo    â”‚ â”‚
â”‚  â”‚ â€¢ validar_stock â”‚  â”‚                  â”‚  â”‚ â€¢ Auto-logout  â”‚ â”‚
â”‚  â”‚ â€¢ obtener_stock â”‚  â”‚                  â”‚  â”‚                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚         buscador_articulos.py                            â”‚   â”‚
â”‚  â”‚  â€¢ BÃºsqueda avanzada â€¢ Filtros mÃºltiples â€¢ SelecciÃ³n    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CAPA DE PERSISTENCIA                           â”‚
â”‚                      (SQLite3)                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    almacen.db                              â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚  TABLAS PRINCIPALES:                                       â”‚ â”‚
â”‚  â”‚  â€¢ usuarios          â€¢ sesiones        â€¢ proveedores       â”‚ â”‚
â”‚  â”‚  â€¢ operarios         â€¢ familias        â€¢ ubicaciones       â”‚ â”‚
â”‚  â”‚  â€¢ almacenes         â€¢ articulos       â€¢ movimientos â­    â”‚ â”‚
â”‚  â”‚  â€¢ albaranes         â€¢ inventarios     â€¢ inventario_detalleâ”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚  VISTAS:                                                   â”‚ â”‚
â”‚  â”‚  â€¢ vw_stock          â€¢ vw_stock_total                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ FLUJO DE DATOS - MOVIMIENTOS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TIPOS DE MOVIMIENTOS                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. ENTRADA (RecepciÃ³n de Proveedor)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚PROVEEDOR â”‚â”€â”€â”€â”€â”€â”€â†’â”‚ ALMACÃ‰N (A)  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   Campos: destino_id, albaran, coste_unit

2. TRASPASO (Entre Almacenes)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ALMACÃ‰N (A)  â”‚â”€â”€â”€â”€â”€â”€â†’â”‚ ALMACÃ‰N (B)  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   Campos: origen_id, destino_id

3. IMPUTACION (Consumo en OT)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ALMACÃ‰N (A)  â”‚â”€â”€â”€â”€â”€â”€â†’â”‚   OBRA (OT)  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   Campos: origen_id, ot, operario_id

4. DEVOLUCION (Retorno a Proveedor)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ALMACÃ‰N (A)  â”‚â”€â”€â”€â”€â”€â”€â†’â”‚PROVEEDOR â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   Campos: origen_id, motivo

5. PERDIDA (Material Extraviado)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ALMACÃ‰N (A)  â”‚â”€â”€â”€â”€Xâ”€â”€â”‚ELIMINADO â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   Campos: origen_id, motivo
```

---

## ğŸ—‚ï¸ ESTRUCTURA DE VENTANAS

```
app.py (AplicaciÃ³n Principal)
â”‚
â”œâ”€â”€ LoginWindow
â”‚   â””â”€â”€ AutenticaciÃ³n â†’ crea MainMenuWindow
â”‚
â”œâ”€â”€ MainMenuWindow (MenÃº Principal)
â”‚   â”‚
â”‚   â”œâ”€â”€ Operaciones Diarias
â”‚   â”‚   â”œâ”€â”€ VentanaRecepcion        â†’ ventana_recepcion.py
â”‚   â”‚   â”œâ”€â”€ VentanaMovimientos      â†’ ventana_movimientos.py
â”‚   â”‚   â”œâ”€â”€ VentanaImputacion       â†’ ventana_imputacion.py
â”‚   â”‚   â”œâ”€â”€ VentanaDevolucion       â†’ ventana_devolucion.py
â”‚   â”‚   â”œâ”€â”€ VentanaMaterialPerdido  â†’ ventana_material_perdido.py (admin)
â”‚   â”‚   â””â”€â”€ VentanaInventario       â†’ ventana_inventario.py
â”‚   â”‚
â”‚   â”œâ”€â”€ MenuInformes (Submenu)
â”‚   â”‚   â”œâ”€â”€ VentanaStock            â†’ ventana_stock.py
â”‚   â”‚   â”œâ”€â”€ VentanaHistorico        â†’ ventana_historico.py
â”‚   â”‚   â””â”€â”€ VentanaFichaArticulo    â†’ ventana_ficha_articulo.py
â”‚   â”‚
â”‚   â””â”€â”€ MaestrosWindow (Submenu)
â”‚       â”œâ”€â”€ VentanaProveedores      â†’ ventana_proveedores.py
â”‚       â”œâ”€â”€ VentanaArticulos        â†’ ventana_articulos.py
â”‚       â”œâ”€â”€ VentanaOperarios        â†’ ventana_operarios.py
â”‚       â”œâ”€â”€ VentanaFamilias         â†’ ventana_familias.py
â”‚       â””â”€â”€ VentanaUbicaciones      â†’ ventana_ubicaciones.py
â”‚
â””â”€â”€ IdleManager (Gestor de Inactividad)
    â””â”€â”€ Monitorea actividad y cierra sesiÃ³n si inactivo
```

---

## ğŸ“‹ FLUJO OPERATIVO TÃPICO

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   DÃA TÃPICO EN EL ALMACÃ‰N                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

08:00 - Login del usuario "almacen"
        â”‚
        â”œâ”€â†’ Apertura de sesiÃ³n en tabla 'sesiones'
        â””â”€â†’ Inicio de IdleManager

08:15 - Llega material del proveedor
        â”‚
        â””â”€â†’ RECEPCIÃ“N
            â”œâ”€ Seleccionar Proveedor: "Proveedor ABC"
            â”œâ”€ AlbarÃ¡n: "ALB-2025-001"
            â”œâ”€ Escanear artÃ­culos y cantidades
            â”‚  â€¢ Art001: 50 unidades
            â”‚  â€¢ Art002: 30 unidades
            â”œâ”€ Destino: "AlmacÃ©n Central"
            â””â”€ GUARDAR â†’ Movimientos tipo ENTRADA creados

09:00 - Preparar furgoneta para operario
        â”‚
        â””â”€â†’ MOVIMIENTOS
            â”œâ”€ Origen: "AlmacÃ©n Central"
            â”œâ”€ Destino: "Furgoneta 1"
            â”œâ”€ Art001: 10 unidades
            â”œâ”€ Art003: 5 unidades
            â””â”€ GUARDAR â†’ Movimientos tipo TRASPASO creados

10:30 - Operario consume material en obra
        â”‚
        â””â”€â†’ IMPUTACIÃ“N
            â”œâ”€ OT: "OT-2025-123"
            â”œâ”€ Operario: "Juan PÃ©rez"
            â”œâ”€ Origen: "Furgoneta 1"
            â”œâ”€ Art001: 3 unidades
            â””â”€ GUARDAR â†’ Movimiento tipo IMPUTACION creado

14:00 - Consulta de stock
        â”‚
        â””â”€â†’ INFORMACIÃ“N â†’ STOCK
            â”œâ”€ Filtrar por familia
            â”œâ”€ Ver stock actual en todos los almacenes
            â””â”€ Exportar a Excel

16:00 - Material defectuoso
        â”‚
        â””â”€â†’ DEVOLUCIÃ“N
            â”œâ”€ Proveedor: "Proveedor XYZ"
            â”œâ”€ Origen: "AlmacÃ©n Central"
            â”œâ”€ Art005: 2 unidades
            â”œâ”€ Motivo: "Material defectuoso"
            â””â”€ GUARDAR â†’ Movimiento tipo DEVOLUCION creado

17:30 - Fin de jornada
        â”‚
        â””â”€â†’ Logout o cierre automÃ¡tico por inactividad
```

---

## ğŸ” CÃLCULO DE STOCK (Vista vw_stock)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CÃ“MO SE CALCULA EL STOCK ACTUAL                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Stock de un artÃ­culo = ENTRADAS - SALIDAS

ENTRADAS (aumentan stock):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  tipo = 'ENTRADA'   â†’ destino_id     â”‚
  â”‚  tipo = 'TRASPASO'  â†’ destino_id     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

SALIDAS (disminuyen stock):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  tipo = 'IMPUTACION' â†’ origen_id     â”‚
  â”‚  tipo = 'PERDIDA'    â†’ origen_id     â”‚
  â”‚  tipo = 'DEVOLUCION' â†’ origen_id     â”‚
  â”‚  tipo = 'TRASPASO'   â†’ origen_id     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Ejemplo:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Tipo  â”‚Cantidad â”‚  Origen  â”‚ Destino  â”‚  Delta   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ENTRADA â”‚   100   â”‚    -     â”‚ Alm. A   â”‚ Alm.A +100â”‚
â”‚TRASPASOâ”‚    20   â”‚  Alm. A  â”‚ Furgo 1  â”‚ A:-20 F:+20â”‚
â”‚IMPUTAC.â”‚     5   â”‚ Furgo 1  â”‚    -     â”‚ Furgo:-5 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Stock Final:
  â€¢ AlmacÃ©n A:  100 - 20 = 80 unidades
  â€¢ Furgoneta 1: 20 - 5 = 15 unidades
  â€¢ Stock Total: 80 + 15 = 95 unidades
```

---

## ğŸ¯ CARACTERÃSTICAS CLAVE DEL SISTEMA

### âœ… Ventajas Principales

1. **Control Total de Stock**
   - Stock en tiempo real por almacÃ©n
   - Alertas de stock mÃ­nimo
   - Trazabilidad completa de movimientos

2. **GestiÃ³n de Inventarios**
   - Inventarios fÃ­sicos programados
   - Ajustes automÃ¡ticos de diferencias
   - HistÃ³rico de inventarios

3. **ImputaciÃ³n a OT**
   - Control de consumos por obra
   - AsignaciÃ³n a operarios
   - AnÃ¡lisis de costes por proyecto

4. **Trazabilidad Completa**
   - HistÃ³rico de todos los movimientos
   - RelaciÃ³n con albaranes
   - Registro de responsables

5. **ExportaciÃ³n de Datos**
   - Excel para informes
   - Filtros avanzados
   - Datos listos para anÃ¡lisis

### ğŸ”’ Seguridad

- AutenticaciÃ³n con contraseÃ±as hasheadas
- Control de roles (admin/almacÃ©n)
- Sesiones por usuario/equipo
- Timeout por inactividad
- Log de errores

### ğŸ“Š Reporting

- Stock actual por almacÃ©n
- HistÃ³rico de movimientos
- Consumos por OT
- Consumos por operario
- ValoraciÃ³n de inventario

---

## ğŸ“ˆ ESTADÃSTICAS DEL PROYECTO

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      MÃ‰TRICAS DEL CÃ“DIGO               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Archivos Python:        24              â”‚
â”‚ LÃ­neas de cÃ³digo:       ~8,500          â”‚
â”‚ Ventanas:               18              â”‚
â”‚ Tablas BD:              13              â”‚
â”‚ Vistas BD:              2               â”‚
â”‚ Ãndices BD:             12              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    DISTRIBUCIÃ“N DE CÃ“DIGO              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Ventanas operativas:    ~35%            â”‚
â”‚ Ventanas maestros:      ~25%            â”‚
â”‚ Ventanas consulta:      ~20%            â”‚
â”‚ Utilidades:             ~15%            â”‚
â”‚ Componentes UI:         ~5%             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ PALETA DE COLORES DEL SISTEMA

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      TEMA VISUAL                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Colores Principales:
  â€¢ Fondo ventanas:     #f8fafc (gris muy claro)
  â€¢ Fondo inputs:       #ffffff (blanco)
  â€¢ Bordes:             #cbd5e1 (gris claro)
  â€¢ Texto:              #1e293b (gris oscuro)
  â€¢ BotÃ³n primario:     #3b82f6 (azul)
  â€¢ BotÃ³n hover:        #2563eb (azul oscuro)
  â€¢ Ã‰xito:              #10b981 (verde)
  â€¢ Error:              #ef4444 (rojo)
  â€¢ Advertencia:        #f59e0b (naranja)

Iconos (Emojis):
  ğŸ” Login            ğŸ“¦ RecepciÃ³n        ğŸ”„ Movimientos
  ğŸ“ ImputaciÃ³n       â†©ï¸ DevoluciÃ³n       âš ï¸ Perdido
  ğŸ“Š Inventario       ğŸ“ˆ Stock            ğŸ“‹ HistÃ³rico
  âš™ï¸ Maestros         ğŸ­ Proveedores      ğŸ‘· Operarios
  ğŸ“‚ Familias         ğŸ“ Ubicaciones      â„¹ï¸ Info
```

---

## ğŸš€ ROADMAP DE MEJORAS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FASE 1 - Completado âœ…                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ“ Sistema de login y autenticaciÃ³n                             â”‚
â”‚ âœ“ GestiÃ³n de maestros (proveedores, artÃ­culos, etc.)           â”‚
â”‚ âœ“ RecepciÃ³n de material                                        â”‚
â”‚ âœ“ Movimientos de stock                                         â”‚
â”‚ âœ“ ImputaciÃ³n a OT                                              â”‚
â”‚ âœ“ Devoluciones y pÃ©rdidas                                      â”‚
â”‚ âœ“ Inventarios fÃ­sicos                                          â”‚
â”‚ âœ“ Consultas de stock e histÃ³rico                               â”‚
â”‚ âœ“ ExportaciÃ³n a Excel                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FASE 2 - En desarrollo ğŸ”§                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â—¯ GestiÃ³n de almacenes/furgonetas                              â”‚
â”‚ â—¯ AsignaciÃ³n automÃ¡tica de furgonetas                          â”‚
â”‚ â—¯ GrÃ¡ficos y dashboards                                        â”‚
â”‚ â—¯ Alertas de stock bajo                                        â”‚
â”‚ â—¯ Backup automÃ¡tico programado                                 â”‚
â”‚ â—¯ ConfiguraciÃ³n avanzada                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FASE 3 - Planificado ğŸ“‹                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â—¯ AnÃ¡lisis de consumos por perÃ­odo                             â”‚
â”‚ â—¯ AnÃ¡lisis de rotaciÃ³n de stock                                â”‚
â”‚ â—¯ ValoraciÃ³n de inventario                                     â”‚
â”‚ â—¯ Informes avanzados PDF                                       â”‚
â”‚ â—¯ IntegraciÃ³n con ERP                                          â”‚
â”‚ â—¯ API REST                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FASE 4 - Futuro ğŸŒŸ                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â—¯ MigraciÃ³n a PostgreSQL                                       â”‚
â”‚ â—¯ App mÃ³vil para operarios                                     â”‚
â”‚ â—¯ Lector de cÃ³digos de barras hardware                         â”‚
â”‚ â—¯ ImpresiÃ³n de etiquetas                                       â”‚
â”‚ â—¯ Sistema de notificaciones                                    â”‚
â”‚ â—¯ Panel web de consulta                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¡ TIPS PARA DESARROLLADORES

### Para Programadores VBA que migran a Python:

1. **ConexiÃ³n a BD:**
   ```python
   # En lugar de ADODB.Connection
   con = sqlite3.connect("almacen.db")
   cur = con.cursor()
   ```

2. **Consultas:**
   ```python
   # En lugar de rs = conn.Execute("SELECT...")
   cur.execute("SELECT * FROM articulos WHERE id=?", (id,))
   row = cur.fetchone()
   ```

3. **Recorrer resultados:**
   ```python
   # En lugar de Do While Not rs.EOF
   for row in cur.fetchall():
       print(row)
   ```

4. **Mensajes:**
   ```python
   # En lugar de MsgBox
   QMessageBox.information(self, "TÃ­tulo", "Mensaje")
   ```

5. **Formularios:**
   ```python
   # En lugar de Form.Controls("txtNombre").Value
   self.txt_nombre.text()
   ```

### Estructura de una Ventana TÃ­pica:

```python
class MiVentana(QWidget):
    def __init__(self):
        super().__init__()
        self.setWindowTitle("Mi Ventana")
        self.setupUI()
    
    def setupUI(self):
        # Crear layout y widgets
        layout = QVBoxLayout(self)
        
        # AÃ±adir componentes
        self.txt_dato = QLineEdit()
        btn_guardar = QPushButton("Guardar")
        btn_guardar.clicked.connect(self.guardar)
        
        layout.addWidget(self.txt_dato)
        layout.addWidget(btn_guardar)
    
    def guardar(self):
        # LÃ³gica al hacer clic
        dato = self.txt_dato.text()
        # ... guardar en BD
```

---

## ğŸ“ INFORMACIÃ“N DE CONTACTO Y SOPORTE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SISTEMA CLIMATOT ALMACÃ‰N                     â”‚
â”‚                                                                  â”‚
â”‚  VersiÃ³n:    1.0                                                â”‚
â”‚  Fecha:      Octubre 2025                                       â”‚
â”‚  TecnologÃ­a: Python 3.12+ | PySide6 | SQLite3                  â”‚
â”‚  Licencia:   Uso Interno                                        â”‚
â”‚                                                                  â”‚
â”‚  DocumentaciÃ³n completa en:                                     â”‚
â”‚  â€¢ DOCUMENTACION_CLIMATOT_ALMACEN.md                           â”‚
â”‚  â€¢ DIAGRAMA_ARQUITECTURA.md (este archivo)                     â”‚
â”‚                                                                  â”‚
â”‚  Logs del sistema:                                              â”‚
â”‚  â€¢ logs/log.txt                                                 â”‚
â”‚                                                                  â”‚
â”‚  Base de datos:                                                 â”‚
â”‚  â€¢ db/almacen.db                                                â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Fin del Diagrama de Arquitectura**

Este documento complementa la documentaciÃ³n principal y ofrece una
vista visual y esquemÃ¡tica del sistema Climatot AlmacÃ©n.
